import streamlit as st
import random
import datetime
import os
import base64

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå bg_yipsy.jpg ‡∏ó‡∏µ‡πà‡∏Å‡∏µ‡πâ‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î)
def set_bg_hack(main_bg):
    if not os.path.exists(main_bg):
        return
    
    with open(main_bg, "rb") as f:
        data = f.read()
    b64_encoded = base64.b64encode(data).decode()
    
    st.markdown(
         f"""
         <style>
         .stApp {{
             background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url(data:image/jpg;base64,{b64_encoded});
             background-size: cover;
             background-position: center;
             color: white;
         }}
         /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏û‡πà */
         .stMarkdown p, .stSubheader, .stTitle {{
             text-shadow: 2px 2px 4px #000000;
             color: white !important;
         }}
         .stTextInput label, .stDateInput label {{
             color: #FFD700 !important; /* ‡∏™‡∏µ‡∏ó‡∏≠‡∏á‡∏°‡∏á‡∏Ñ‡∏• */
             font-weight: bold;
         }}
         div[data-testid="stMetricValue"] {{
             color: #00FF00 !important; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå */
             font-weight: bold;
         }}
         </style>
         """,
         unsafe_allow_html=True
     )

# ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (‡∏Å‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ä‡∏∑‡πà‡∏≠ bg_yipsy.jpg ‡πÄ‡∏Ç‡πâ‡∏≤ GitHub ‡∏ô‡∏∞)
set_bg_hack('bg_yipsy.jpg') 

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÅ‡∏≠‡∏û
st.set_page_config(page_title="Lucky 246 (‡∏°‡∏´‡∏≤‡πÄ‡∏Æ‡∏á)", page_icon="üîÆ")

st.title("üîÆ Lucky 246 (‡∏°‡∏´‡∏≤‡πÄ‡∏Æ‡∏á)")
st.subheader("‡∏Ç‡∏∏‡∏°‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå & ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ")

# ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
name = st.text_input("‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏û‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å The Sun)")
birthday = st.date_input("‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î", min_value=datetime.date(1950, 1, 1))

# ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏¢‡∏¥‡∏õ‡∏ã‡∏µ‡∏°‡∏´‡∏≤‡πÄ‡∏Æ‡∏á
fortune_texts = [
    "‚òÄÔ∏è ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏°‡∏≤‡πÄ‡∏¢‡∏∑‡∏≠‡∏ô‡∏î‡∏±‡πà‡∏á‡πÅ‡∏™‡∏á‡∏≠‡∏∏‡∏©‡∏≤ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î‡∏°‡∏ô‡∏à‡∏∞‡∏Ñ‡∏•‡∏µ‡πà‡∏Ñ‡∏•‡∏≤‡∏¢ ‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡∏Å‡πâ‡∏≠‡∏ô‡πÇ‡∏ï‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏∏‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤!",
    "‚òÄÔ∏è ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå: ‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏ä‡∏±‡∏¢‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏±‡∏Å‡∏©‡πå ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏°‡∏ï‡∏ï‡∏≤‡πÄ‡∏≠‡πá‡∏ô‡∏î‡∏π",
    "‚òÄÔ∏è ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå: ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏°‡∏≤‡πÄ‡∏ó‡∏°‡∏≤‡∏î‡∏±‡πà‡∏á‡∏™‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ ‡∏°‡∏µ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÑ‡∏î‡πâ‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡πÑ‡∏Å‡∏•‡∏ô‡∏≥‡∏Ç‡πà‡∏≤‡∏ß‡∏î‡∏µ‡∏°‡∏≤‡πÉ‡∏´‡πâ",
    "‚òÄÔ∏è ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå: ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏¢‡πÉ‡∏à‡∏à‡∏∞‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÄ‡∏ö‡πà‡∏á‡∏ö‡∏≤‡∏ô‡∏™‡∏î‡πÉ‡∏™ ‡πÉ‡∏Ñ‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡∏à‡∏∞‡∏™‡∏°‡∏´‡∏ß‡∏±‡∏á‡πÉ‡∏ô 3-7 ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ",
    "‚òÄÔ∏è ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå: ‡∏ö‡∏≤‡∏£‡∏°‡∏µ‡∏´‡∏ô‡∏∏‡∏ô‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≥‡∏£‡∏ß‡∏¢ ‡∏´‡∏¢‡∏¥‡∏ö‡∏à‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≠‡∏á ‡πÄ‡∏•‡∏Ç‡∏°‡∏á‡∏Ñ‡∏•‡∏à‡∏∞‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏Ñ‡πÉ‡∏´‡∏ç‡πà!"
]

if st.button("üîÆ ‡∏™‡∏≤‡∏ò‡∏∏... ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏°‡∏´‡∏≤‡πÄ‡∏Æ‡∏á"):
    if not name or " " not in name or len(name) < 5:
        st.error("‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏ß‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô")
    else:
        random.seed(name + str(birthday) + str(datetime.date.today()))
        selected_fortune = random.choice(fortune_texts)
        lucky_numbers = [random.randint(0, 9) for _ in range(3)]
        lucky_str = "".join(map(str, lucky_numbers))
        
        st.divider()
        st.balloons()
        
        st.markdown(f"### üìú ‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏°‡∏´‡∏≤‡πÄ‡∏Æ‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì {name}")
        st.success(selected_fortune)
        
        col1, col2 = st.columns(2)
        with col1:
            st.metric("‚ú® ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ", lucky_str)
        with col2:
            st.metric("üí∞ ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ", f"{random.randint(85, 100)}%")

        st.divider()
        
        # ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏π (‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏µ‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ß‡πâ)
        st.markdown("### üôè ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏ß‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏π")
        st.write("‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡πÉ‡∏à ‡∏£‡πà‡∏ß‡∏°‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏π 9 ‡∏ö‡∏≤‡∏ó ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏•‡πÄ‡∏õ‡∏¥‡∏î‡∏ó‡∏≤‡∏á‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†")
        
        try:
            # ‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ QR
            st.image("004999022551005_20260228_162145.jpeg", caption="‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏π‡πÉ‡∏´‡πâ ‡∏ô‡∏≤‡∏¢ ‡∏ö‡∏î‡∏¥‡∏ô‡∏ó‡∏£‡πå", width=300)
        except:
            st.warning("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û QR Code...")
        
        st.success("üôè ‡∏™‡∏≤‡∏ò‡∏∏... ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ï‡∏≤‡πÄ‡∏´‡πá‡∏ô!")
